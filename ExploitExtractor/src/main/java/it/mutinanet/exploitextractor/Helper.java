package it.mutinanet.exploitextractor;
import java.util.ArrayList;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class Helper {

//	private static Pattern KEY_VALUE_PATTERN = Pattern.compile(
//			"!%!\\[(\\w+)\\]\\[(\\w+)\\]", Pattern.CASE_INSENSITIVE);

	private static Pattern KEY_VALUE_PATTERN = Pattern.compile(
			"!%!\\[(\\w+)\\]\\[([^\\]]+)\\]", Pattern.CASE_INSENSITIVE);
	public static List<KeyValue> parseKeyValue(String text)
			throws ParsingException {
		Matcher matcher = KEY_VALUE_PATTERN.matcher(text);
		List<KeyValue> retval = new ArrayList<KeyValue>();
		while (matcher.find()) {
			retval.add(new KeyValue(matcher.group(1), matcher.group(2)));
		}
		if (!retval.isEmpty()) {
			return retval;
		}
		throw new ParsingException(
				"The string doesn't match the key-value pattern "
						+ KEY_VALUE_PATTERN);

	}

	// Test
	// public static void main(String[] args) throws ParsingException {
	// KeyValue keyValue = parseKeyValue("!%![ciao][bello]");
	// System.out.println(keyValue.getKey());
	// System.out.println(keyValue.getValue());
	// }

}
